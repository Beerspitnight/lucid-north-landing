<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The True Cost of Substitute Scheduling</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts for better typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .selection-button {
            transition: all 0.2s ease-in-out;
        }
        .selection-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header Section -->
    <header class="bg-white shadow-md">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <h1 class="text-4xl font-bold text-gray-900">The Hidden Costs of Manual Sub Scheduling</h1>
            <p class="mt-2 text-lg text-gray-600">A data-driven analysis of how much districts spend on Assistant Principal salaries for daily substitute coverage.</p>
        </div>
    </header>

    <!-- Main Content Section -->
    <main class="py-10">
        <div class="max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-12">

            <!-- Interactive Drilldown Section -->
            <section>
                <h2 class="text-2xl font-bold text-center mb-2 text-gray-900">Calculate the Cost for a Specific School</h2>
                <p class="text-center text-gray-600 mb-6">Select a location to see the specific annual cost of sub scheduling.</p>

                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <!-- Navigation breadcrumbs -->
                    <div id="breadcrumbs" class="flex items-center text-sm text-gray-500 mb-4"></div>
                    
                    <!-- Dynamic selection area -->
                    <div id="selection-area" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                        <!-- Buttons will be dynamically inserted here -->
                    </div>

                    <!-- Results Display -->
                    <div id="results-card" class="mt-8 bg-blue-50 p-6 rounded-lg border border-blue-200 hidden">
                        <h3 class="text-xl font-bold text-blue-900" id="results-title"></h3>
                        <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4 text-center">
                            <div>
                                <p class="text-sm text-blue-700">Median/Actual AP Salary</p>
                                <p class="text-2xl font-bold text-blue-900" id="results-salary"></p>
                            </div>
                            <div>
                                <p class="text-sm text-blue-700">Estimated Annual Scheduling Cost</p>
                                <p class="text-2xl font-bold text-blue-900" id="results-cost"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="bg-white mt-16">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-gray-500 text-sm">
            <p>&copy; 2025 Lucid North LLC. For marketing purposes only.</p>
            <p class="mt-1">Calculations are based on a 180-day school year and an assumed 230-day work year for salary conversion.</p>
        </div>
    </footer>

    <script>
        // --- DATA PREPARATION ---
        const rawSurveyData = [
          {"state": "GA", "school_level": "Middle", "time_to_complete_tuesday": "5 minutes ", "time_to_complete_friday": "15 minutes "},
          {"state": "VA", "school_level": "Elementary", "time_to_complete_tuesday": "20 minutes", "time_to_complete_friday": "30 minutes "},
          {"state": "AK", "school_level": "Elementary", "time_to_complete_tuesday": "40 minutes", "time_to_complete_friday": "50 minutes"},
          {"state": "MD", "school_level": "Middle", "time_to_complete_tuesday": "30 minutes ", "time_to_complete_friday": "44 minutes "},
          {"state": "TX", "school_level": "High", "time_to_complete_tuesday": "45", "time_to_complete_friday": "45"},
          {"state": "NJ", "school_level": "High", "time_to_complete_tuesday": "10 minutes", "time_to_complete_friday": "15 minutes"},
          {"state": "NJ", "school_level": "Middle", "time_to_complete_tuesday": "45 minutes", "time_to_complete_friday": "45 minutes"},
          {"state": "WI", "school_level": "Middle", "time_to_complete_tuesday": "20", "time_to_complete_friday": "45"},
          {"state": "AZ", "school_level": "Elementary", "time_to_complete_tuesday": "10", "time_to_complete_friday": "25"},
          {"state": "OH", "school_level": "High", "time_to_complete_tuesday": "30 minutes", "time_to_complete_friday": "30 minutes"},
          {"state": "CA", "school_level": "High", "time_to_complete_tuesday": "15 minutes", "time_to_complete_friday": "30 minutes"},
          {"state": "NY", "school_level": "Elementary", "time_to_complete_tuesday": "15 minutes", "time_to_complete_friday": "25 minutes"},
          {"state": "FL", "school_level": "High", "time_to_complete_tuesday": "30-45 minutes", "time_to_complete_friday": "30-45 minutes"},
          {"state": "MA", "school_level": "High", "time_to_complete_tuesday": "20 minutes", "time_to_complete_friday": "45 minutes"},
          {"state": "MO", "school_level": "High", "time_to_complete_tuesday": "20 minutes", "time_to_complete_friday": "30 minutes"},
          {"state": "CO", "school_level": "Middle", "time_to_complete_tuesday": "15 mins", "time_to_complete_friday": "45 mins."},
          {"state": "WA", "school_level": "Middle", "time_to_complete_tuesday": "45 minutes ", "time_to_complete_friday": "45 minutes "},
          {"state": "MD", "school_level": "High", "time_to_complete_tuesday": "30 minutes plus", "time_to_complete_friday": "45-60"},
        ];

        // Hierarchical location and salary data structure
        const locationData = {
            "NJ": {
                "Central": {
                    "Middlesex": {
                        "South Brunswick": {
                            "South Brunswick High School": { salary: 123029.79, level: "High" },
                            "Crossroads North Middle School": { salary: 113139.30, level: "Middle" },
                            "Crossroads South Middle School": { salary: 119510.89, level: "Middle" }
                        }
                    }
                }
            }
        };

        // State-level median salaries as a fallback
        const stateMedianSalaries = {
            "AZ": { "Elementary": 81200, "Middle": 81200, "High": 75300 },
            "CA": { "Elementary": 82800, "Middle": 107500, "High": 107800 },
            "CO": { "Elementary": 86300, "Middle": 88900, "High": 88900 },
            "FL": { "Elementary": 62700, "Middle": 92500, "High": 81900 },
            "GA": { "Elementary": 70800, "Middle": 94300, "High": 92500 },
            "MD": { "Elementary": 102400, "Middle": 108500, "High": 115000 },
            "MA": { "Elementary": 91600, "Middle": 106400, "High": 106400 },
            "NJ": { "Elementary": 85100, "Middle": 105900, "High": 111200 },
            "NY": { "Elementary": 91800, "Middle": 92500, "High": 113300 },
            "NC": { "Elementary": 76200, "Middle": 92900, "High": 99600 },
            "OH": { "Elementary": 79700, "Middle": 95200, "High": 104200 },
            "PA": { "Elementary": 84600, "Middle": 97300, "High": 98400 },
            "TX": { "Elementary": 78100, "Middle": 95300, "High": 102100 },
            "VA": { "Elementary": 83100, "Middle": 98400, "High": 108600 },
            "WA": { "Elementary": 95000, "Middle": 95800, "High": 95800 },
            "WI": { "Elementary": 84600, "Middle": 96100, "High": 110600 }
        };

        const parseTime = (timeStr) => {
            if (!timeStr || typeof timeStr !== 'string') return null;
            const cleanedTime = timeStr.toLowerCase().replace(/,/g, '');
            if (cleanedTime.includes('hour')) {
                const hours = parseFloat(cleanedTime.replace(/hours?/, '').trim());
                return isNaN(hours) ? null : hours * 60;
            }
            const numbers = cleanedTime.match(/\d+(\.\d+)?/g);
            if (!numbers) return null;
            const totalMinutes = numbers.map(n => parseFloat(n)).reduce((acc, val) => acc + val, 0);
            return totalMinutes / numbers.length;
        };
        
        const processedData = rawSurveyData.map(d => ({
            state: d.state,
            level: d.school_level,
            time_fri: parseTime(d.time_to_complete_friday),
            time_tue: parseTime(d.time_to_complete_tuesday)
        })).filter(d => d.time_tue !== null && d.time_fri !== null && d.state && d.level);

        // --- UI AND CALCULATION LOGIC ---
        
        let currentPath = [];
        const selectionArea = document.getElementById('selection-area');
        const breadcrumbs = document.getElementById('breadcrumbs');
        const resultsCard = document.getElementById('results-card');

        const formatCurrency = (value) => `$${value.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;

        const calculateCost = (salary, level) => {
            const relevantData = processedData.filter(d => d.level === level);
            if (relevantData.length === 0) return { cost: 0, tue: 0, fri: 0 };

            const avgTue = relevantData.map(d => d.time_tue).reduce((a, b) => a + b, 0) / relevantData.length;
            const avgFri = relevantData.map(d => d.time_fri).reduce((a, b) => a + b, 0) / relevantData.length;

            const perDiemRate = salary / 230; // Based on 230 work days
            const hourlyRate = perDiemRate / 8; // Assuming 8-hour day
            
            const weeklyMinutes = (avgTue * 4) + avgFri;
            const weeklyHours = weeklyMinutes / 60;
            const annualCost = weeklyHours * 36 * hourlyRate; // 180 days = 36 school weeks

            return { cost: annualCost, tue: avgTue, fri: avgFri };
        };

        const updateResults = (title, salary, level) => {
            const { cost, tue, fri } = calculateCost(salary, level);
            document.getElementById('results-title').textContent = title;
            document.getElementById('results-salary').textContent = formatCurrency(salary);
            document.getElementById('results-cost').textContent = formatCurrency(cost);
            resultsCard.classList.remove('hidden');
        };

        const renderSelections = () => {
            selectionArea.innerHTML = '';
            resultsCard.classList.add('hidden');
            let currentLevelData = locationData;
            for (const key of currentPath) {
                currentLevelData = currentLevelData[key];
            }

            // Update breadcrumbs
            breadcrumbs.innerHTML = '<button data-path-index="-1" class="hover:text-blue-600">Home</button>';
            currentPath.forEach((segment, index) => {
                breadcrumbs.innerHTML += `<span class="mx-2">/</span><button data-path-index="${index}" class="hover:text-blue-600">${segment.replace(/_/g, ' ')}</button>`;
            });

            if (currentLevelData.salary) { // This is a school
                updateResults(currentPath[currentPath.length - 1].replace(/_/g, ' '), currentLevelData.salary, currentLevelData.level);
            } else { // This is a directory
                Object.keys(currentLevelData).forEach(key => {
                    const button = document.createElement('button');
                    button.textContent = key.replace(/_/g, ' ');
                    button.className = 'selection-button bg-white p-4 rounded-lg shadow-md text-gray-700 font-semibold hover:bg-blue-500 hover:text-white';
                    button.onclick = () => {
                        currentPath.push(key);
                        renderSelections();
                    };
                    selectionArea.appendChild(button);
                });
            }
        };

        breadcrumbs.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                const pathIndex = parseInt(e.target.dataset.pathIndex);
                currentPath = currentPath.slice(0, pathIndex + 1);
                renderSelections();
            }
        });

        document.addEventListener('DOMContentLoaded', renderSelections);

    </script>

</body>
</html>
